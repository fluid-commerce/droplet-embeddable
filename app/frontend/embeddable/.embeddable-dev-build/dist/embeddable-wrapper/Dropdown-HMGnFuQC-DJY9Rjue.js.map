{"version":3,"file":"Dropdown-HMGnFuQC-DJY9Rjue.js","sources":["../../../node_modules/@embeddable.com/vanilla-components/src/components/vanilla/controls/Dropdown/Dropdown.emb.ts"],"sourcesContent":["import { DimensionOrMeasure, OrderBy, OrderDirection, Value, loadData } from '@embeddable.com/core';\nimport { EmbeddedComponentMeta, Inputs, defineComponent } from '@embeddable.com/react';\nimport { SortDirection } from '../../../../enums/SortDirection';\nimport SortDirectionType from '../../../../types/SortDirection.type.emb';\n\nimport Component, { Props } from './index';\n\nexport const meta = {\n  name: 'Dropdown',\n  label: 'Dropdown',\n  defaultWidth: 300,\n  defaultHeight: 80,\n  classNames: ['on-top'],\n  category: 'Controls: inputs & dropdowns',\n  inputs: [\n    {\n      name: 'ds',\n      type: 'dataset',\n      label: 'Dataset',\n      description: 'Dataset',\n      category: 'Dropdown values',\n    },\n    {\n      name: 'property',\n      type: 'dimension',\n      label: 'Property',\n      config: {\n        dataset: 'ds',\n      },\n      category: 'Dropdown values',\n    },\n    {\n      name: 'sortBy',\n      type: 'dimensionOrMeasure',\n      label: 'Optional Sort By Additional Dimension or Measure',\n      config: {\n        dataset: 'ds',\n      },\n      category: 'Dropdown values',\n    },\n    {\n      name: 'sortDirection',\n      type: SortDirectionType,\n      defaultValue: SortDirection.DESCENDING,\n      label: 'Sort direction',\n      category: 'Chart data',\n    },\n    {\n      name: 'title',\n      type: 'string',\n      label: 'Title',\n      category: 'Settings',\n    },\n    {\n      name: 'defaultValue',\n      type: 'string',\n      label: 'Default value',\n      category: 'Pre-configured variables',\n    },\n    {\n      name: 'placeholder',\n      type: 'string',\n      label: 'Placeholder',\n      category: 'Settings',\n    },\n    {\n      name: 'limit',\n      type: 'number',\n      label: 'Default number of options',\n      defaultValue: 100,\n      category: 'Settings',\n    },\n  ],\n  events: [\n    {\n      name: 'onChange',\n      label: 'Change',\n      properties: [\n        {\n          name: 'value',\n          type: 'string',\n        },\n      ],\n    },\n  ],\n  variables: [\n    {\n      name: 'dropdown choice',\n      type: 'string',\n      defaultValue: Value.noFilter(),\n      inputs: ['defaultValue'],\n      events: [{ name: 'onChange', property: 'value' }],\n    },\n  ],\n} as const satisfies EmbeddedComponentMeta;\n\nexport default defineComponent<Props, typeof meta, { search: string }>(Component, meta, {\n  props: (inputs: Inputs<typeof meta>, [embState]) => {\n    if (!inputs.ds)\n      return {\n        ...inputs,\n        options: [] as never,\n      };\n    const defaultSortDirection = inputs.sortDirection === 'Ascending' ? 'asc' : 'desc';\n    const orderProp: OrderBy[] = [];\n\n    if (inputs.sortBy) {\n      orderProp.push({\n        property: inputs.sortBy,\n        direction: defaultSortDirection,\n      });\n    }\n\n    const select: DimensionOrMeasure[] = inputs.property ? [inputs.property] : [];\n    if (inputs.sortBy) {\n      select.push(inputs.sortBy);\n    }\n\n    return {\n      ...inputs,\n      options: loadData({\n        from: inputs.ds,\n        select,\n        limit: inputs.limit || 1000,\n        orderBy: orderProp,\n        filters:\n          embState?.search && inputs.property\n            ? [\n                {\n                  operator: 'contains',\n                  property: inputs.property,\n                  value: embState?.search,\n                },\n              ]\n            : undefined,\n      }),\n    };\n  },\n  events: {\n    onChange: (value) => {\n      return {\n        value: value || Value.noFilter(),\n      };\n    },\n  },\n});\n"],"names":["value","Value","embState","inputs","orderProp","select","loadData","defaultSortDirection","Dropdown_emb","defineComponent","Component","meta","SortDirectionType","p","SortDirection"],"mappings":"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"}