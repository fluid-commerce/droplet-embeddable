{"version":3,"file":"PieChart-DLV5F34y-2kKBYEYD.js","sources":["../../../node_modules/@embeddable.com/vanilla-components/src/components/vanilla/charts/PieChart/PieChart.emb.ts","../../../node_modules/@embeddable.com/vanilla-components/src/components/vanilla/charts/PieChart/index.tsx"],"sourcesContent":["import { Value, loadData } from '@embeddable.com/core';\nimport { EmbeddedComponentMeta, Inputs, defineComponent } from '@embeddable.com/react';\n\nimport Component from './index';\n\nexport const meta = {\n  name: 'PieChart',\n  label: 'Pie chart',\n  classNames: ['inside-card'],\n  category: 'Charts: essentials',\n  inputs: [\n    {\n      name: 'ds',\n      type: 'dataset',\n      label: 'Dataset to display',\n      category: 'Chart data',\n    },\n    {\n      name: 'slice',\n      type: 'dimension',\n      label: 'Slice',\n      required: true,\n      config: {\n        dataset: 'ds',\n      },\n      category: 'Chart data',\n    },\n    {\n      name: 'metric',\n      type: 'measure',\n      label: 'Metric',\n      required: true,\n      config: {\n        dataset: 'ds',\n      },\n      category: 'Chart data',\n    },\n    {\n      name: 'title',\n      type: 'string',\n      label: 'Title',\n      description: 'The title for the chart',\n      category: 'Chart settings',\n    },\n    {\n      name: 'description',\n      type: 'string',\n      label: 'Description',\n      description: 'The description for the chart',\n      category: 'Chart settings',\n    },\n    {\n      name: 'showLegend',\n      type: 'boolean',\n      label: 'Turn on the legend',\n      defaultValue: true,\n      category: 'Chart settings',\n    },\n    {\n      name: 'maxSegments',\n      type: 'number',\n      label: 'Max Legend items',\n      defaultValue: 8,\n      category: 'Chart settings',\n    },\n    {\n      name: 'showLabels',\n      type: 'boolean',\n      label: 'Show Labels',\n      defaultValue: false,\n      category: 'Chart settings',\n    },\n    {\n      name: 'displayAsPercentage',\n      type: 'boolean',\n      label: 'Display as Percentages',\n      defaultValue: false,\n      category: 'Chart settings',\n    },\n    {\n      name: 'dps',\n      type: 'number',\n      label: 'Decimal Places',\n      category: 'Formatting',\n    },\n    {\n      name: 'enableDownloadAsCSV',\n      type: 'boolean',\n      label: 'Show download as CSV',\n      category: 'Export options',\n      defaultValue: true,\n    },\n    {\n      name: 'enableDownloadAsPNG',\n      type: 'boolean',\n      label: 'Show download as PNG',\n      category: 'Export options',\n      defaultValue: true,\n    },\n  ],\n  events: [\n    {\n      name: 'onClick',\n      label: 'Click',\n      properties: [\n        {\n          name: 'slice',\n          type: 'string',\n        },\n        {\n          name: 'metric',\n          type: 'number',\n        },\n      ],\n    },\n  ],\n} as const satisfies EmbeddedComponentMeta;\n\nexport default defineComponent(Component, meta, {\n  props: (inputs: Inputs<typeof meta>) => {\n    return {\n      ...inputs,\n      granularity: inputs.slice?.inputs?.granularity,\n      results: loadData({\n        from: inputs.ds,\n        select: [inputs.slice, inputs.metric],\n      }),\n    };\n  },\n  events: {\n    onClick: (value) => {\n      return {\n        slice: value.slice || Value.noFilter(),\n        metric: value.metric || Value.noFilter(),\n      };\n    },\n  },\n});\n","import { DataResponse, Dimension, Measure, Granularity } from '@embeddable.com/core';\nimport {\n  ArcElement,\n  CategoryScale,\n  Chart as ChartJS,\n  ChartOptions,\n  InteractionItem,\n  Legend,\n  LineElement,\n  LinearScale,\n  PointElement,\n  Title,\n  Tooltip,\n} from 'chart.js';\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\nimport React, { useRef, useState, useMemo } from 'react';\nimport { Pie, getElementAtEvent } from 'react-chartjs-2';\n\nimport formatValue from '../../../util/format';\nimport Container from '../../Container';\nimport { setChartJSDefaults } from '../../../util/chartjs/common';\nimport { Theme } from '../../../../themes/theme';\nimport { useTheme } from '@embeddable.com/react';\n\nChartJS.register(\n  ChartDataLabels,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  ArcElement,\n  Title,\n  Tooltip,\n  Legend,\n);\n\ntype Props = {\n  results: DataResponse;\n  title: string;\n  dps?: number;\n  slice: Dimension;\n  metric: Measure;\n  showLabels?: boolean;\n  showLegend?: boolean;\n  maxSegments?: number;\n  displayAsPercentage?: boolean;\n  enableDownloadAsCSV?: boolean;\n  onClick: (args: { slice: string | null; metric: string | null }) => void;\n  granularity?: Granularity;\n};\n\ntype PropsWithRequiredTheme = Props & { theme: Theme };\ntype Record = { [p: string]: string };\n\nexport default (props: Props) => {\n  const { results, title, enableDownloadAsCSV, maxSegments, metric, slice, onClick, granularity } = props;\n\n  const theme: Theme = useTheme() as Theme;\n\n  // Create mapped data with proper date formatting\n  const mappedData = useMemo(() => {\n    let dateFormat: string | undefined;\n    if (slice?.nativeType === 'time' && granularity && granularity in theme.dateFormats) {\n      dateFormat = theme.dateFormats[granularity as keyof typeof theme.dateFormats];\n    }\n    \n    return results?.data?.map((d) => ({\n      ...d,\n      ...(slice?.name && {\n        [slice.name]: dateFormat\n          ? formatValue(d?.[slice.name], {\n              meta: slice?.meta,\n              dateFormat,\n            })\n          : d?.[slice.name],\n      }),\n    })) ?? [];\n  }, [results?.data, slice, granularity, theme.dateFormats]);\n  // Set ChartJS defaults\n  setChartJSDefaults(theme, 'pie');\n\n  // Check for color overrides in the theme\n  let chartColors = theme.charts.colors;\n  if (theme.charts.pie.colors) {\n    chartColors = theme.charts.pie.colors;\n  }\n\n  // Add the theme to props\n  const updatedProps: PropsWithRequiredTheme = {\n    ...props,\n    theme,\n    results: { ...results, data: mappedData },\n  };\n\n  const [clickedIndex, setClickedIndex] = useState<number | null>(null);\n\n  const chartRef = useRef<ChartJS<'pie', []>>(null);\n\n  const fireClickEvent = (element: InteractionItem[]) => {\n    if (!element.length || element[0].index === clickedIndex) {\n      //clicked outside pie, or re-clicked slice\n      onClick({ slice: null, metric: null });\n      setClickedIndex(null);\n      return;\n    }\n    const { datasetIndex, index } = element[0];\n    if (maxSegments && index + 1 >= maxSegments) {\n      // clicked \"OTHER\"\n      return;\n    }\n    setClickedIndex(index);\n    onClick({\n      slice: mappedData?.[index][slice.name],\n      metric: mappedData?.[index][metric.name],\n    });\n  };\n\n  const handleClick = (event: React.MouseEvent<HTMLCanvasElement>) => {\n    const { current: chart } = chartRef;\n\n    if (!chart) {\n      return;\n    }\n\n    fireClickEvent(getElementAtEvent(chart, event));\n  };\n\n  return (\n    <Container {...props} className=\"overflow-y-hidden\">\n      <Pie\n        height=\"100%\"\n        options={chartOptions(updatedProps, theme)}\n        data={chartData(updatedProps, chartColors)}\n        ref={chartRef}\n        onClick={handleClick}\n      />\n    </Container>\n  );\n};\n\nfunction chartOptions(props: Props, theme: Theme): ChartOptions<'pie'> {\n  return {\n    responsive: true,\n    maintainAspectRatio: false,\n    animation: {\n      duration: 400,\n      easing: 'linear',\n    },\n    cutout: '45%',\n    plugins: {\n      datalabels: {\n        // Great resource: https://quickchart.io/documentation/chart-js/custom-pie-doughnut-chart-labels/\n        backgroundColor: theme.charts.pie.labels.backgroundColor,\n        borderRadius: theme.charts.pie.labels.borderRadius,\n        color: theme.charts.pie.labels.color,\n        display: props.showLabels ? 'auto' : false,\n        font: {\n          size: theme.charts.pie.labels.font.size,\n          weight: theme.charts.pie.labels.font.weight,\n        },\n        formatter: (v) => {\n          const val = v\n            ? formatValue(v, {\n                type: 'number',\n                dps: props.dps,\n                meta: props.displayAsPercentage ? undefined : props.metric.meta,\n              })\n            : null;\n          return props.displayAsPercentage ? `${val}%` : val;\n        },\n      },\n      tooltip: {\n        //https://www.chartjs.org/docs/latest/configuration/tooltip.html\n        callbacks: {\n          label: function (context) {\n            let label = context.dataset.label || '';\n            // handle labels that are booleans\n            if (typeof context.dataset.label === 'boolean') {\n              label = context.dataset.label ? 'True' : 'False';\n            }\n            if (context.parsed !== null) {\n              label += `: ${formatValue(`${context.parsed || ''}`, {\n                type: 'number',\n                dps: props.dps,\n                meta: props.displayAsPercentage ? undefined : props.metric.meta,\n              })}`;\n            }\n            label = props.displayAsPercentage ? `${label}%` : label;\n            return label;\n          },\n        },\n      },\n      legend: {\n        display: props.showLegend,\n        position: 'bottom',\n        labels: {\n          usePointStyle: true,\n          boxHeight: 10,\n        },\n      },\n    },\n  };\n}\n\nfunction mergeLongTail(data: any[], slice: Dimension, metric: Measure, maxSegments: number) {\n  if (!maxSegments || !metric || !slice) return data;\n\n  const newData = [...(data || [])]\n    .sort((a, b) => parseInt(b[metric.name]) - parseInt(a[metric.name]))\n    .slice(0, maxSegments - 1);\n\n  const sumLongTail = data\n    ?.slice(maxSegments - 1)\n    .reduce((accumulator, record: Record) => accumulator + parseInt(record[metric.name]), 0);\n\n  newData.push({ [slice.name]: 'Other', [metric.name]: sumLongTail });\n\n  return newData;\n}\n\nfunction chartData(props: PropsWithRequiredTheme, chartColors: string[]) {\n  const { maxSegments, results, metric, slice, displayAsPercentage, theme } = props;\n  const labelsExceedMaxSegments = maxSegments && maxSegments < (results?.data?.length || 0);\n  const newData = labelsExceedMaxSegments ? mergeLongTail(results.data || [], slice, metric, maxSegments) : results.data;\n\n  // Chart.js pie expects labels like so: ['US', 'UK', 'Germany']\n  const labels = newData?.map((d) => d[slice.name]);\n  const sum = displayAsPercentage\n    ? newData?.reduce((accumulator, obj) => accumulator + parseFloat(obj[metric.name]), 0)\n    : null;\n\n  // Chart.js pie expects counts like so: [23, 10, 5]\n  const counts = newData?.map((d: Record) => {\n    const metricValue = parseFloat(d[metric.name]);\n    return displayAsPercentage && sum ? (metricValue * 100) / sum : metricValue;\n  });\n\n  return {\n    labels,\n    datasets: [\n      {\n        data: counts,\n        backgroundColor: chartColors,\n        borderColor: theme.charts.pie.borderColor,\n        borderWidth: theme.charts.pie.borderWidth,\n        weight: theme.charts.pie.weight,\n      },\n    ],\n  };\n}\n"],"names":["value","Value","inputs","loadData","_b","_a","PieChart_emb","defineComponent","Component","meta","theme","chartColors","counts","labels","metricValue","displayAsPercentage","sum","metric","maxSegments","results","slice","props","newData","mergeLongTail","accumulator","obj","chartData","sumLongTail","data","a","b","record","label","context","formatValue","val","v","chartOptions","handleClick","chartRef","updatedProps","Pie","jsx","Container","chart","fireClickEvent","getElementAtEvent","event","mappedData","index","setClickedIndex","onClick","datasetIndex","element","clickedIndex","useState","useRef","setChartJSDefaults","_","granularity","dateFormat","d","title","enableDownloadAsCSV","useTheme","useMemo","Tooltip","Legend","Title","M","ArcElement","R","LineElement","I","PointElement","LinearScale","T","CategoryScale","ChartDataLabels","L","ChartJS"],"mappings":"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"}