{"version":3,"file":"GranularityPicker-CIeazKOI-D6vF5ooF.js","sources":["../../../node_modules/@embeddable.com/vanilla-components/src/components/vanilla/controls/GranularityPicker/GranularityPicker.emb.ts","../../../node_modules/@embeddable.com/vanilla-components/src/components/vanilla/controls/GranularityPicker/index.tsx"],"sourcesContent":["import { Value, loadData, Granularity } from '@embeddable.com/core';\nimport { EmbeddedComponentMeta, Inputs, defineComponent } from '@embeddable.com/react';\n\nimport Component, { Props } from './index';\n\nexport const meta = {\n  name: 'GranularityPicker',\n  label: 'Granularity Picker',\n  defaultWidth: 200,\n  defaultHeight: 80,\n  classNames: ['on-top'],\n  category: 'Controls: inputs & dropdowns',\n  inputs: [\n    {\n      name: 'defaultValue',\n      type: 'granularity',\n      label: 'Default granularity',\n      category: 'Chart settings',\n    },\n    {\n      name: 'title',\n      type: 'string',\n      label: 'Title',\n      defaultValue: '',\n      category: 'Chart settings',\n    },\n    ...[\n      { value: 'second', defaultValue: false },\n      { value: 'minute', defaultValue: false },\n      { value: 'hour', defaultValue: false },\n      { value: 'day', defaultValue: true },\n      { value: 'week', defaultValue: true },\n      { value: 'month', defaultValue: true },\n      { value: 'quarter', defaultValue: true },\n      { value: 'year', defaultValue: true },\n    ].map((option: { value: string; defaultValue: boolean }) => ({\n      name: option.value,\n      type: 'boolean' as const,\n      label: `Display ${option.value}`,\n      defaultValue: option.defaultValue,\n      category: 'Granularity options',\n    })),\n  ],\n  events: [\n    {\n      name: 'onChange',\n      label: 'Change Granularity',\n      properties: [\n        {\n          name: 'value',\n          type: 'granularity',\n        },\n        {\n          name: 'dateRange',\n          type: 'timeRange',\n        },\n      ],\n    },\n  ],\n  variables: [\n    {\n      name: 'granularity',\n      type: 'granularity',\n      defaultValue: 'day',\n      inputs: ['defaultValue'],\n      events: [{ name: 'onChange', property: 'value' }],\n    },\n    {\n      name: 'date range',\n      type: 'timeRange',\n      defaultValue: { relativeTimeString: 'Last 30 days' },\n      events: [{ name: 'onChange', property: 'dateRange' }],\n    },\n  ],\n} as const satisfies EmbeddedComponentMeta;\n\nexport default defineComponent(Component, meta, {\n  props: (inputs: Inputs<typeof meta>) => {\n    return {\n      ...inputs,\n    };\n  },\n  events: {\n    onChange: ({ value, dateRange }) => {\n      if (!dateRange.relativeTimeString) {\n        return {\n          value: value,\n          dateRange: Value.noFilter(),\n        };\n      }\n      return {\n        value: value,\n        dateRange: dateRange,\n      };\n    },\n  },\n});\n","import { useEmbeddableState } from '@embeddable.com/react';\nimport { Dimension, Granularity } from '@embeddable.com/core';\nimport React, { useState } from 'react';\nimport Container from '../../Container';\nimport Dropdown from '../Dropdown';\n\nexport type Props = {\n  day?: boolean;\n  defaultValue: Granularity;\n  hour?: boolean;\n  minute?: boolean;\n  month?: boolean;\n  onChange: (object: object) => void;\n  quarter?: boolean;\n  second?: boolean;\n  title?: string;\n  week?: boolean;\n  year?: boolean;\n};\n\ntype GranularityResponse = {\n  isLoading: boolean;\n  data: { value: string }[];\n};\n\nexport default (props: Props) => {\n  const { title } = props;\n  const [granularity, setGranularity] = useState(props.defaultValue);\n\n  const options: Granularity[] = [\n    'second',\n    'minute',\n    'hour',\n    'day',\n    'week',\n    'month',\n    'quarter',\n    'year',\n  ];\n\n  const timeFilters: { [key: string]: string | undefined } = {\n    second: 'last 1 minute',\n    minute: 'last 1 hour',\n    hour: 'last 24 hours',\n    day: 'last 30 days',\n    week: 'last 12 months',\n    month: 'last 24 months',\n    quarter: 'last 24 months',\n    year: undefined, //clears filter\n  };\n\n  const handleChange = (granularity: string) => {\n    const eventObject = {\n      value: granularity,\n      dateRange: {\n        to: undefined,\n        from: undefined,\n        relativeTimeString: timeFilters[granularity],\n      },\n    };\n    props.onChange(eventObject);\n    setGranularity(granularity as Granularity);\n  };\n\n  const granularityOptions = (): GranularityResponse => {\n    const data: { value: Granularity }[] = [];\n    //display options selected by user\n    options.filter((option) => props[option])?.forEach((option) => data.push({ value: option }));\n    return {\n      isLoading: false,\n      data: data,\n    };\n  };\n\n  const valueProp: Dimension = {\n    __type__: 'dimension',\n    name: 'value',\n    nativeType: 'string',\n    title: 'Value',\n  };\n\n  return (\n    <Container title={title}>\n      <div className=\"flex items-center h-10 \">\n        <div className=\"grow basis-0 h-full\">\n          <Dropdown\n            unclearable\n            minDropdownWidth={320}\n            defaultValue={props.defaultValue}\n            options={granularityOptions()}\n            placeholder=\"Granularity\"\n            property={valueProp}\n            onChange={(v) => handleChange(v)}\n          />\n        </div>\n      </div>\n    </Container>\n  );\n};\n"],"names":["value","Value","dateRange","inputs","GranularityPicker_emb","defineComponent","Component","meta","option","valueProp","v","handleChange","granularityOptions","props","Dropdown","jsx","Container","title","data","_a","options","eventObject","setGranularity","granularity","timeFilters","useState"],"mappings":"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"}