{"version":3,"file":"getBarChartOptions-B4IGPfRT-Q4fKI4Ki-DKQmduZK.js","sources":["../../../node_modules/@embeddable.com/vanilla-components/src/components/util/getBarChartOptions.ts"],"sourcesContent":["import { DataResponse, Measure } from '@embeddable.com/core';\nimport { ChartDataset, ChartOptions } from 'chart.js';\n\nimport formatValue from '../util/format';\nimport { setYAxisStepSize } from './chartjs/common';\nimport { Props } from './getStackedChartData';\nimport { Theme } from '../../themes/theme';\n\n// We're adding a few properties to use when showing totals on the chart\ntype ExtendedChartDataset = ChartDataset<'bar' | 'line'> & {\n  totals?: { [key: string]: { total: number; lastSegment: number | null } };\n  xAxisNames?: string[];\n};\n\nconst getPadding = (\n  showLabels: boolean,\n  showTotals: boolean,\n  stacked: boolean,\n  displayHorizontally: boolean,\n) => {\n  let left = 0;\n  let right = 0;\n  let top = 0;\n  const bottom = 0;\n  if (!stacked) {\n    if (displayHorizontally) {\n      right = showLabels ? 60 : 0;\n      left = showLabels ? 60 : 0;\n    } else {\n      top = showLabels ? 20 : 0;\n    }\n  } else {\n    if (displayHorizontally) {\n      right = showTotals ? 60 : 0;\n      left = showTotals ? 60 : 0;\n    } else {\n      top = showTotals ? 20 : 0;\n    }\n  }\n  return { left, right, top, bottom };\n};\n\nexport default function getBarChartOptions({\n  displayAsPercentage = false,\n  displayHorizontally = false,\n  dps = undefined,\n  isGroupedBar,\n  lineMetrics,\n  metric,\n  metrics,\n  results,\n  reverseXAxis = false,\n  secondAxisTitle = '',\n  segment,\n  showLabels = false,\n  showLegend = false,\n  showSecondYAxis = false,\n  showTotals = false,\n  stackBars,\n  stackMetrics = false,\n  stacked = false,\n  theme,\n  xAxis,\n  xAxisTitle = '',\n  yAxisTitle = '',\n}: Partial<Props> & {\n  theme: Theme;\n  isGroupedBar?: boolean;\n  lineMetrics?: Measure[];\n  metric?: Measure;\n  metrics?: Measure[];\n  results?: DataResponse;\n  reverseXAxis?: boolean;\n  secondAxisTitle?: string;\n  showSecondYAxis?: boolean;\n  stackBars?: boolean;\n  stackMetrics?: boolean;\n  stacked?: boolean;\n  xAxisTitle?: string;\n  yAxisTitle?: string;\n}): ChartOptions<'bar' | 'line'> {\n  return {\n    responsive: true,\n    maintainAspectRatio: false,\n    indexAxis: displayHorizontally ? ('y' as const) : ('x' as const),\n    layout: {\n      padding: getPadding(showLabels, showTotals, stacked, displayHorizontally),\n    },\n    scales: {\n      y: {\n        stacked: stacked || stackMetrics,\n        grace: '0%',\n        grid: {\n          display: false,\n        },\n        max:\n          displayAsPercentage && !displayHorizontally\n            ? isGroupedBar\n              ? stackBars\n                ? 100\n                : undefined\n              : 100\n            : undefined,\n        afterDataLimits: function (axis) {\n          //Disable fractions unless they exist in the data.\n          const metricsGroup = [\n            ...(metric !== undefined ? [metric] : []),\n            ...(metrics || []),\n            ...(lineMetrics && !showSecondYAxis ? lineMetrics : []),\n          ];\n          setYAxisStepSize(axis, results, metricsGroup, dps);\n        },\n        ticks: {\n          //https://www.chartjs.org/docs/latest/axes/labelling.html\n          callback: function (value) {\n            if (displayHorizontally) {\n              return this.getLabelForValue(parseFloat(`${value}`));\n            }\n\n            return displayAsPercentage\n              ? `${value}%`\n              : formatValue(typeof value === 'number' ? value.toString() : value, {\n                  type: 'number',\n                });\n          },\n        },\n        title: {\n          display: !!yAxisTitle,\n          text: yAxisTitle,\n        },\n      },\n      y1: {\n        //optional second y-axis for optional line metrics\n        display: showSecondYAxis,\n        grace: '0%',\n        grid: {\n          display: false,\n        },\n        position: 'right',\n        title: {\n          display: !!secondAxisTitle,\n          text: secondAxisTitle,\n        },\n        afterDataLimits: function (axis) {\n          //Disable fractions unless they exist in the data.\n          const metricsGroup = [...(lineMetrics && showSecondYAxis ? lineMetrics : [])];\n          setYAxisStepSize(axis, results, metricsGroup, dps);\n        },\n      },\n      x: {\n        reverse: reverseXAxis && !displayHorizontally,\n        stacked: stacked || stackMetrics,\n        grid: {\n          display: false,\n        },\n        max:\n          displayAsPercentage && displayHorizontally\n            ? isGroupedBar\n              ? stackBars\n                ? 100\n                : undefined\n              : 100\n            : undefined,\n        ticks: {\n          //https://www.chartjs.org/docs/latest/axes/labelling.html\n          callback: function (value) {\n            if (!displayHorizontally) {\n              return this.getLabelForValue(parseFloat(`${value}`));\n            }\n\n            return displayAsPercentage\n              ? `${value}%`\n              : formatValue(typeof value === 'number' ? value.toString() : value, {\n                  type: 'number',\n                });\n          },\n        },\n        title: {\n          display: !!xAxisTitle,\n          text: xAxisTitle,\n        },\n      },\n    },\n    animation: {\n      duration: 400,\n      easing: 'linear',\n    },\n    plugins: {\n      legend: {\n        display: showLegend,\n        position: 'bottom',\n        labels: {\n          usePointStyle: true,\n          boxHeight: 8,\n        },\n      },\n      tooltip: {\n        //https://www.chartjs.org/docs/latest/configuration/tooltip.html\n        callbacks: {\n          label: function (context) {\n            let label = context.dataset.label || '';\n            //metric needed for formatting\n            const metricIndex = context.datasetIndex;\n            //a single metric is sometimes passed in (e.g. for stacked bar charts)\n            const metricsList = [...(metrics || []), ...(lineMetrics || [])];\n            const metricObj = metrics ? metricsList[metricIndex] : metric;\n            if (context.parsed && typeof context.parsed === 'object') {\n              const axis = displayHorizontally ? 'x' : 'y';\n              label += `: ${formatValue(`${context.parsed[axis]}`, {\n                type: 'number',\n                dps: dps,\n                meta: displayAsPercentage ? undefined : metricObj?.meta,\n              })}`;\n              if (displayAsPercentage) {\n                label += '%';\n              }\n            }\n            return label;\n          },\n        },\n      },\n      datalabels: {\n        labels: {\n          total: {\n            anchor: (context) => {\n              const dataset = context.dataset as ExtendedChartDataset;\n              const totals = dataset.totals;\n              if (!totals) {\n                return 'end';\n              }\n              const currXAxisName = dataset.xAxisNames?.[context.dataIndex];\n              const currTotal = totals[currXAxisName || '']?.total;\n              if (currTotal && currTotal < 0) {\n                return 'start';\n              }\n              return 'end';\n            },\n            align: (context) => {\n              const dataset = context.dataset as ExtendedChartDataset;\n              const totals = dataset.totals;\n              if (!totals) {\n                return displayHorizontally ? 'right' : 'top';\n              }\n              const currXAxisName = dataset.xAxisNames?.[context.dataIndex];\n              const currTotal = totals[currXAxisName || '']?.total;\n              if (currTotal && currTotal < 0) {\n                return displayHorizontally ? 'left' : 'bottom';\n              }\n              return displayHorizontally ? 'right' : 'top';\n            },\n            display: showTotals && stackBars ? 'true' : false,\n            backgroundColor: theme.charts.bar.labels.total.backgroundColor,\n            borderRadius: theme.charts.bar.labels.total.borderRadius,\n            color: theme.charts.bar.labels.total.color,\n            font: {\n              size: theme.charts.bar.labels.total.font.size,\n              weight: theme.charts.bar.labels.total.font.weight,\n            },\n            formatter: (v, context) => {\n              const dataset = context.dataset as ExtendedChartDataset;\n              const xAxisNames = dataset.xAxisNames;\n              const totals = dataset.totals;\n              if (!totals || !xAxisNames) {\n                return '';\n              }\n              const currxAxisName = xAxisNames[context.dataIndex];\n              const currDatasetIndex = context.datasetIndex;\n              if (currDatasetIndex === totals[currxAxisName].lastSegment && v !== null) {\n                const barTotal = displayAsPercentage\n                  ? '100'\n                  : totals[currxAxisName].total.toString();\n                let val = formatValue(barTotal, {\n                  type: 'number',\n                  dps: dps,\n                  meta: displayAsPercentage ? undefined : metric?.meta,\n                });\n                if (displayAsPercentage) {\n                  val += '%';\n                }\n                return val;\n              } else {\n                return ''; // has to be here or chartjs decides we want a number on every bart part\n              }\n            },\n          },\n          value: {\n            //https://chartjs-plugin-datalabels.netlify.app/guide/\n            anchor: stacked || stackMetrics ? 'center' : 'end',\n            align: stacked || stackMetrics ? 'center' : 'end',\n            display: showLabels ? 'auto' : false,\n            backgroundColor: theme.charts.bar.labels.value.backgroundColor,\n            borderRadius: theme.charts.bar.labels.value.borderRadius,\n            color: theme.charts.bar.labels.value.color,\n            font: {\n              size: theme.charts.bar.labels.value.font.size,\n              weight: theme.charts.bar.labels.value.font.weight,\n            },\n            formatter: (v, context) => {\n              //metric needed for formatting\n              const metricIndex = context.datasetIndex;\n              //a single metric is sometimes passed in (e.g. for stacked bar charts)\n              const metricsList = [...(metrics || []), ...(lineMetrics || [])];\n              const metricObj = metrics ? metricsList[metricIndex] : metric;\n              if (v === null) return null;\n              let val = formatValue(v, {\n                type: 'number',\n                dps: dps,\n                meta: displayAsPercentage ? undefined : metricObj?.meta,\n              });\n              if (displayAsPercentage) {\n                val += '%';\n              }\n              return val;\n            },\n          },\n        },\n      },\n    },\n  };\n}\n"],"names":["val","displayAsPercentage","dps","metricObj","formatValue","v","metricIndex","context","metricsList","metrics","lineMetrics","metric","theme","showLabels","stacked","stackMetrics","barTotal","totals","currxAxisName","xAxisNames","dataset","showTotals","stackBars","currTotal","displayHorizontally","currXAxisName","_a","_b","label","axis","showLegend","xAxisTitle","value","isGroupedBar","reverseXAxis","setYAxisStepSize","F","results","metricsGroup","showSecondYAxis","secondAxisTitle","yAxisTitle","getPadding","xAxis","segment","getBarChartOptions","right","left","top","bottom"],"mappings":"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"}