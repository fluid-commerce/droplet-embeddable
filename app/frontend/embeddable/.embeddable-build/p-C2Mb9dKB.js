import{D as e}from"./p-DZclBDBz.js";import{G as a,k as t}from"./p-CptBl6Le.js";import{S as i}from"./p-D-ZJqqO3.js";import{W as r,B as o,I as l,w as s,Y as n,U as p,v as d,P as m,k as u,E as c,M as y,m as g,a as b}from"./p-CYoZIMuL.js";import"./p-DRQaGU8r.js";import{D as f}from"./p-UGbmf8ph.js";import{R as h}from"./p-CawJ6rMd.js";import{n as v,s as C,c as x}from"./p-BvW5kj19.js";import{m as D}from"./p-e2Wdry-T.js";import{r as A}from"./p-BIFnrNPV.js";import{P as j}from"./p-BDmepEmC.js";import"./p-DUIxdZrE.js";import"./p-BcYWNS4N.js";import"./p-CBK12GNN.js";import"./p-sWS4yEkp.js";s.register(n,p,d,m,u,c,y,g,b);const w=e=>{const a=t(),s=f.useMemo((()=>({...e,theme:a,granularity:e.granularity||"day"})),[e,a]);r(a,"line");const{fillGaps:n}=h(s,"desc"),p=f.useMemo((()=>{var e,t;const{results:i,prevResults:r,metrics:o,applyFill:l}=s,p=(e=i==null?void 0:i.data)==null?void 0:e.reduce(n,[]),d=(t=r==null?void 0:r.data)==null?void 0:t.reduce(n,[]),m=(o==null?void 0:o.map(((e,t)=>({xAxisID:"period",label:e.title,data:(p==null?void 0:p.map((a=>{var t;return{y:parseFloat(a[e.name]||"0"),x:v(a[((t=s.xAxis)==null?void 0:t.name)||""])}})))||[],backgroundColor:l?A(a.charts.colors[t%a.charts.colors.length],.2):a.charts.colors[t%a.charts.colors.length],borderColor:a.charts.colors[t%a.charts.colors.length],pointRadius:0,tension:a.charts.line.lineTension,pointHoverRadius:3,fill:l,cubicInterpolationMode:a.charts.line.cubicInterpolationMode}))))||[];return{datasets:[...m,...m.map(((e,t)=>{const i=A(a.charts.colors[t%a.charts.colors.length],.5);return{cubicInterpolationMode:a.charts.bar.cubicInterpolationMode,showLine:!!s.prevTimeFilter,xAxisID:"comparison",label:`Previous ${o[t].title}`,data:s.prevTimeFilter?(d==null?void 0:d.map((e=>{var a;return{y:parseFloat(e[o[t].name]||"0"),x:v(e[((a=s.comparisonXAxis)==null?void 0:a.name)||s.xAxis.name||""])}})))||[]:[],backgroundColor:l?A(a.charts.colors[t%a.charts.colors.length],.05):i,borderColor:i,pointRadius:0,tension:a.charts.line.lineTension,pointHoverRadius:3,fill:l&&!!s.prevTimeFilter,segment:{borderDash:[10,5]}}}))]}}),[s,n,a]),d=f.useMemo((()=>{var e,t,i,r,l,n,p,d;const m={period:C(s.timeFilter),comparison:C(s.prevTimeFilter)};return{responsive:true,maintainAspectRatio:false,interaction:{mode:"index",intersect:false},layout:{padding:{left:0,right:0,top:s.showLabels?20:0,bottom:0}},scales:{y:{min:s.yAxisMin,grace:"0%",grid:{display:false},title:{display:!!s.yAxisTitle,text:s.yAxisTitle},callback:function(e){return x(e.toString(),{type:"number"})},afterDataLimits:function(e){o(e,s.results,[...s.metrics],s.dps)}},period:{min:(t=(e=m.period)==null?void 0:e.from)==null?void 0:t.toJSON(),max:(r=(i=m.period)==null?void 0:i.to)==null?void 0:r.toJSON(),grid:{display:false},type:"time",time:{round:s.granularity,isoWeekday:true,displayFormats:a.dateFormats,unit:s.granularity},title:{display:!!s.xAxisTitle,text:s.xAxisTitle}},comparison:{min:(n=(l=m.comparison)==null?void 0:l.from)==null?void 0:n.toJSON(),max:(d=(p=m.comparison)==null?void 0:p.to)==null?void 0:d.toJSON(),display:!!s.comparisonXAxis,grid:{display:false},type:"time",time:{round:s.granularity,isoWeekday:true,displayFormats:a.dateFormats,unit:s.granularity},title:{display:!!s.comparisonXAxisTitle,text:s.comparisonXAxisTitle}}},animation:{duration:400,easing:"linear"},plugins:{legend:{display:s.showLegend,position:"bottom",labels:{usePointStyle:true,boxHeight:8}},tooltip:{callbacks:{title:e=>D(e,s.granularity,a),label:function(e){const a=e.datasetIndex%s.metrics.length,t=s.metrics[a];let i=e.dataset.label||"";return e.parsed.y!==null&&(i+=`: ${x(`${e.parsed.y}`,{type:"number",dps:s.dps,meta:t==null?void 0:t.meta})}`),i}}},datalabels:{align:"top",display:s.showLabels?"auto":false,backgroundColor:a.charts.line.labels.backgroundColor,borderRadius:a.charts.line.labels.borderRadius,color:a.charts.line.labels.color,font:{size:a.charts.line.labels.font.size,weight:a.charts.line.labels.font.weight},formatter:(e,a)=>{const t=a.datasetIndex%s.metrics.length,i=s.metrics[t];return e?x(e.y,{type:"number",dps:s.dps,meta:i==null?void 0:i.meta}):null}}}}}),[s]);return i.jsx(j,{...s,className:"overflow-y-hidden",children:i.jsx(l,{"aria-label":s.title?`Compare Line Chart: ${s.title}`:"Compare Line Chart","aria-roledescription":"compare line chart",height:"100%",options:d,data:p})})},T={name:"CompareLineChart",label:"Line comparison (time-series)",classNames:["inside-card"],category:"Charts: time-series comparison",inputs:[{name:"ds",type:"dataset",label:"Dataset",description:"Dataset",defaultValue:false,category:"Chart data"},{name:"xAxis",type:"dimension",label:"X-Axis",config:{dataset:"ds",supportedTypes:["time"],hideGranularity:true},category:"Chart data"},{name:"comparisonXAxis",type:"dimension",label:"Comparison X-Axis (optional)",config:{dataset:"ds",supportedTypes:["time"],hideGranularity:true},category:"Chart data"},{name:"metrics",type:"measure",array:true,label:"Metrics",config:{dataset:"ds"},category:"Chart data"},{name:"granularity",type:"granularity",label:"Granularity",defaultValue:"day",category:"Variables to configure"},{name:"timeFilter",type:"timeRange",label:"Primary date range",description:"Date range",category:"Variables to configure"},{name:"prevTimeFilter",type:"timeRange",label:"Comparison date range",description:"Date range",category:"Variables to configure"},{name:"title",type:"string",label:"Title",description:"The title for the chart",category:"Chart settings"},{name:"description",type:"string",label:"Description",description:"The description for the chart",category:"Chart settings"},{name:"xAxisTitle",type:"string",label:"X-Axis Title",category:"Chart settings"},{name:"comparisonXAxisTitle",type:"string",label:"Comparison X-Axis Title (optional)",description:"Title for the comparison X-Axis",category:"Chart settings",defaultValue:""},{name:"yAxisTitle",type:"string",label:"Y-Axis Title",category:"Chart settings"},{name:"showLabels",type:"boolean",label:"Show Labels",category:"Chart settings",defaultValue:false},{name:"applyFill",type:"boolean",label:"Color fill space under line",category:"Chart settings",defaultValue:false},{name:"yAxisMin",type:"number",label:"Y-Axis minimum value",category:"Chart settings"},{name:"showLegend",type:"boolean",label:"Show Legend",category:"Chart settings",defaultValue:true},{name:"enableDownloadAsCSV",type:"boolean",label:"Show download as CSV",category:"Export options",defaultValue:true},{name:"enableDownloadAsPNG",type:"boolean",label:"Show download as PNG",category:"Export options",defaultValue:true},{name:"dps",type:"number",label:"Decimal Places",category:"Formatting"}]},V=a(w,T,{props:a=>{var t,i;const r=[];return r.push({property:a.xAxis,direction:"desc"}),{...a,results:e({from:a.ds,limit:500,orderBy:r,select:[{dimension:(t=a.xAxis)==null?void 0:t.name,granularity:a.granularity},a.metrics],filters:a.timeFilter&&a.xAxis?[{property:a.xAxis,operator:"inDateRange",value:a.timeFilter}]:void 0}),prevResults:e({from:a.ds,select:[{dimension:(i=a.xAxis)==null?void 0:i.name,granularity:a.granularity},a.metrics],limit:a.prevTimeFilter?500:1,orderBy:r,filters:a.prevTimeFilter&&a.xAxis?[{property:a.xAxis,operator:"inDateRange",value:{from:a.prevTimeFilter.from,relativeTimeString:"",to:a.prevTimeFilter.to}}]:void 0})}}});export{V as default,T as meta};
//# sourceMappingURL=p-C2Mb9dKB.js.map