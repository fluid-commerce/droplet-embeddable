import{D as e}from"./p-DZclBDBz.js";import{G as a,H as t,k as l}from"./p-CptBl6Le.js";import{S as o}from"./p-D-ZJqqO3.js";import{D as r}from"./p-UGbmf8ph.js";import{P as n}from"./p-BDmepEmC.js";import{L as s}from"./p-BI4YTse8.js";import{c as i}from"./p-BvW5kj19.js";import"./p-CBK12GNN.js";import"./p-sWS4yEkp.js";import"./p-CYoZIMuL.js";import"./p-XDZjB0o3.js";const d=e=>{var a,d,m;const{results:p}=e,[c,u]=r.useState(e.xAxis.name),[y,b]=t({dimension:null}),f=l(),h=(a=e.xAxisOptions)!=null&&a.find((a=>e.xAxis.name===a.name))?e.xAxisOptions:[...e.xAxisOptions||[],e.xAxis],g=e=>{u(e);const a=h.find((a=>e===a.name))||null;b({dimension:a})},v=h.find((e=>c===e.name));let x;(v==null?void 0:v.nativeType)==="time"&&e.granularity&&e.granularity in f.dateFormats&&(x=f.dateFormats[e.granularity]);const w={...e,theme:f,xAxis:v||e.xAxis},C=((d=p==null?void 0:p.data)==null?void 0:d.map((e=>({...e,...(v==null?void 0:v.name)&&{[v.name]:x?i(e==null?void 0:e[v.name],{meta:v==null?void 0:v.meta,dateFormat:x}):e==null?void 0:e[v.name]}}))))??[];return o.jsxs(n,{...e,className:"overflow-y-hidden",children:[o.jsx("div",{className:"flex h-[60px] w-full",children:o.jsx("div",{children:o.jsx("select",{className:`\n              border\n              flex\n              h-10\n              items-center\n              min-w-[50px]\n              px-3\n              relative\n              w-full\n              border-[color:--embeddable-controls-borders-colors-normal]\n              rounded-[--embeddable-controls-borders-radius]\n            `,value:c,onChange:e=>g(e.target.value),children:h==null?void 0:h.map(((e,a)=>o.jsx("option",{value:e.name,children:e.title},a)))})})}),o.jsx("div",{className:"flex grow overflow-hidden",children:p.isLoading||!v||!((m=C==null?void 0:C.filter(((e,a)=>a<10)))!=null&&m.some((e=>e[v.name])))?null:o.jsx(s,{...w,results:{...p,data:C}},c)})]})},m={name:"DynamicAxisBar",label:"Dynamic-axis bar chart",classNames:["inside-card"],category:"Misc",inputs:[{name:"ds",type:"dataset",label:"Dataset to download from",category:"Chart data"},{name:"xAxis",type:"dimension",label:"Default X-axis",config:{dataset:"ds",hideGranularity:true},category:"Chart data"},{name:"xAxisOptions",type:"dimension",array:true,label:"X-axis options",config:{dataset:"ds",hideGranularity:true},category:"Chart data"},{name:"metrics",type:"measure",array:true,label:"Metrics",config:{dataset:"ds"},category:"Chart data"},{name:"granularity",type:"granularity",label:"Granularity (for dates)",defaultValue:"week",category:"Variables to configure"},{name:"title",type:"string",label:"Title",description:"The title for the button",category:"Chart settings"},{name:"description",type:"string",label:"Description",description:"The description for the button",category:"Chart settings"},{name:"showLegend",type:"boolean",label:"Show Legend",category:"Chart settings",defaultValue:true},{name:"showLabels",type:"boolean",label:"Show Labels",category:"Chart settings",defaultValue:false},{name:"displayHorizontally",type:"boolean",label:"Display Horizontally",category:"Chart settings",defaultValue:false},{name:"reverseXAxis",type:"boolean",label:"Reverse X Axis",category:"Chart settings",defaultValue:false},{name:"dps",type:"number",label:"Decimal Places",category:"Formatting"},{name:"enableDownloadAsPNG",type:"boolean",label:"Show download as PNG",category:"Export options",defaultValue:true},{name:"enableDownloadAsCSV",type:"boolean",label:"Show download as CSV",category:"Export options",defaultValue:true}]},p=a(d,m,{props:(a,[t])=>{var l;const o=(l=t==null?void 0:t.dimension)!=null&&l.title?t.dimension:a.xAxis,r=o.nativeType==="time";return{...a,reverseXAxis:a.reverseXAxis||r,results:r?e({from:a.ds,select:[{dimension:o.name,granularity:a.granularity},a.metrics],orderBy:[{property:o,direction:"desc"}],limit:100}):e({from:a.ds,select:[o,a.metrics],orderBy:[{property:a.metrics[0],direction:"desc"}],limit:100})}}});export{p as default,m as meta};
//# sourceMappingURL=p-CcH9Bx0X.js.map