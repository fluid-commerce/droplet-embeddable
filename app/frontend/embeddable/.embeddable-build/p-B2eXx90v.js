import{S as e}from"./p-BG3D11hv.js";import{H as n}from"./p-C4wedjxV.js";import{D as o}from"./p-BpMJ0iVV.js";import{w as r,S as l}from"./p-B7Yk6rNY.js";import{P as s,R as t,T as a}from"./p-D9lurr2W.js";let d;const c=c=>{const i=o.useRef(null),[u,m]=o.useState(false),[b,p]=o.useState(false),[f,h]=o.useState(""),[v,x]=o.useState(false),[w,g]=o.useState(c.defaultValue),[N,k]=n({[c.searchProperty||"search"]:""});o.useEffect((()=>{g(c.defaultValue)}),[c.defaultValue]),o.useEffect((()=>{let e=null;return b?e&&clearTimeout(e):e=setTimeout((()=>{m(false)}),200),()=>{e&&clearTimeout(e)}}),[b]),o.useLayoutEffect((()=>{if(!v)return;const e=setTimeout((()=>{m(false),x(false)}),500);return()=>clearTimeout(e)}),[v]);const T=o.useCallback((e=>{h(e),clearTimeout(d),d=window.setTimeout((()=>{k((n=>({...n,[c.searchProperty||"search"]:e})))}),500)}),[h,k,c.searchProperty]),y=o.useCallback((e=>{T(""),g(e),c.onChange(e),clearTimeout(d)}),[g,c,T]),j=(e,n,o)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),n(e),m(false),x(true)),e.key==="Escape"&&(e.preventDefault(),m(false),x(true))},B=o.useMemo((()=>{var n,o;return(o=(n=c.options)==null?void 0:n.data)==null?void 0:o.reduce(((n,o,r)=>{var l,s;return n.push(e.jsxs("div",{onClick:()=>{var e;m(false),x(true),y(o[((e=c.property)==null?void 0:e.name)||""]||"")},onKeyDown:e=>j(e,(()=>{var e;return y(o[((e=c.property)==null?void 0:e.name)||""]||"")})),className:`flex items-center min-h-[36px] px-3 py-2 hover:bg-black/5 cursor-pointer font-normal ${w===o[((l=c.property)==null?void 0:l.name)||""]?"bg-black/5":""} whitespace-nowrap overflow-hidden text-ellipsis`,tabIndex:0,children:[o[((s=c.property)==null?void 0:s.name)||""],o.note&&e.jsx("span",{className:"font-normal ml-auto pl-3 text-xs opacity-70",children:o.note})]},r)),n}),[])}),[c,w,y]);return e.jsx(s,{title:c.title,children:e.jsxs("div",{className:r(`\n            border\n            flex\n            h-10\n            items-center\n            min-w-[50px]\n            relative\n            w-full\n            bg-[color:--embeddable-controls-backgrounds-colors-soft]\n            border-[color:--embeddable-controls-borders-colors-normal]\n            rounded-[--embeddable-controls-borders-radius]\n          `,c.className),children:[e.jsx("input",{ref:i,value:f,name:"dropdown",placeholder:c.placeholder,onClick:e=>{m(true),x(false)},onFocus:()=>{m(true),x(false),p(true)},onBlur:()=>{p(false)},onChange:e=>T(e.target.value),className:`\n            border-0\n            cursor-pointer\n            h-9\n            leading-9\n            outline-none\n            px-3\n            text-sm ${u||!w?"":"opacity-0"}\n            w-full\n            bg-[color:--embeddable-controls-backgrounds-colors-transparent]\n            rounded-[--embeddable-controls-borders-radius]\n          `}),!!w&&e.jsx("span",{className:`\n              absolute\n              block\n              h-8\n              leading-8\n              left-3\n              overflow-hidden\n              pointer-events-none\n              text-sm ${u?"hidden":""}\n              top-1\n              truncate\n              w-[calc(100%-2.5rem)]\n              whitespace-nowrap\n              rounded-[--embeddable-controls-borders-radius]\n            `,children:w}),u&&e.jsxs("div",{style:{minWidth:c.minDropdownWidth},className:`\n              absolute\n              border\n              flex\n              flex-col\n              max-h-[400px]\n              overflow-x-hidden\n              overflow-y-auto\n              top-11\n              w-full\n              z-50\n              bg-[color:--embeddable-controls-backgrounds-colors-soft]\n              border-[color:--embeddable-controls-borders-colors-normal]\n              rounded-[--embeddable-controls-borders-radius]\n            `,onMouseDown:e=>{var n;e.preventDefault(),(n=i.current)==null||n.focus(),x(false)},onFocus:()=>{p(true)},onBlur:()=>{p(false)},tabIndex:0,children:[B,(B==null?void 0:B.length)===0&&!!f&&e.jsx("div",{className:"px-3 py-2 text-black/50 italic cursor-pointer",children:"No results"})]}),c.options.isLoading?e.jsx(l,{show:true,className:"absolute right-2 top-2 z-1 pointer-events-none"}):e.jsx(t,{className:"absolute right-2 top-2.5 z-1 pointer-events-none"}),!c.unclearable&&!!w&&e.jsx("div",{onClick:()=>{y("")},className:"absolute right-10 top-0 h-10 flex items-center z-10 cursor-pointer",children:e.jsx(a,{})})]})})};export{c as _};
//# sourceMappingURL=p-B2eXx90v.js.map