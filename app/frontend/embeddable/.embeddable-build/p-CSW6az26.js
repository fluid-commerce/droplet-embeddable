import{c as l}from"./p-BvW5kj19.js";function n(n,t,o){var e,a,u;const{displayAsPercentage:r,granularity:s,maxSegments:i,metric:d,results:v,segment:c,showTotals:m,theme:p,totals:x,useCustomDateFormat:b,xAxis:g}=n,F=[...new Set((e=v==null?void 0:v.data)==null?void 0:e.map((l=>l[(g==null?void 0:g.name)||""])))],f=j(),h={},A=(o==null?void 0:o.chartType)==="stackedAreaChart"?0:null;F.forEach((l=>{const n={};f.forEach((l=>n[l]=A)),h[l]=n})),(a=v==null?void 0:v.data)==null||a.forEach((l=>{const n=l[(c==null?void 0:c.name)||""],t=l[(g==null?void 0:g.name)||""],o=l[(d==null?void 0:d.name)||""];f.includes(n)?h[t][n]=parseFloat(o):h[t].Other=(h[t].Other||0)+parseFloat(o)}));let C;return b&&s?C=p.dateFormats[s]:g.nativeType==="time"&&(s&&p.dateFormats[s]?C=p.dateFormats[s]:(u=g==null?void 0:g.inputs)!=null&&u.granularity&&p.dateFormats[g.inputs.granularity]&&(C=p.dateFormats[g.inputs.granularity])),{labels:F.map((n=>l(n,{meta:g==null?void 0:g.meta,dateFormat:C}))),datasets:f.map(((l,n)=>({...t,backgroundColor:p.charts.colors[n%p.charts.colors.length],borderColor:p.charts.colors[n%p.charts.colors.length],label:l,data:F.map((t=>{const o=h[t][l];return m&&x&&o!==null&&(x[t].lastSegment=n),r&&o!==null?parseFloat(`${o*100/f.reduce(((l,n)=>h[t][n]===null?l:h[t][n]+l),0)}`):o})),xAxisNames:F,totals:x})))};function j(){var l,n;const t=[...new Set((l=v==null?void 0:v.data)==null?void 0:l.map((l=>l[(c==null?void 0:c.name)||""]||"No value")))];if(!i||t.length<=i||i<1)return t;const o={};(n=v==null?void 0:v.data)==null||n.forEach((l=>o[l[(c==null?void 0:c.name)||""]]=(o[l[(c==null?void 0:c.name)||""]]||0)+parseInt(l[(d==null?void 0:d.name)||""])));const e=Object.keys(o).map((l=>({name:l,value:o[l]}))).sort(((l,n)=>n.value-l.value)).slice(0,i).map((l=>l.name));return e.push("Other"),e}}export{n as j};
//# sourceMappingURL=p-CSW6az26.js.map